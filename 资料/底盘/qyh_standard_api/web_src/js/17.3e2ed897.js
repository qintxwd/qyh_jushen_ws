(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"64fe":function(t,e,a){"use strict";a("ef58")},"78a7":function(t,e,a){"use strict";a.r(e);a("d866"),a("7d54"),a("ab43");var s=a("2f62"),i=a("f226"),o=a("33aa"),n=a("c48b"),r=a("a39b"),l=a("623d"),c=a("9e68"),p=a("03a3"),h=a("af60"),u=a("e4ef"),d=a("c02f"),m=a("c64e"),g=a("b69e"),y=a("2cd7"),M=a("8a1b"),f=a("1369"),b=a("fbff"),v=a("6e49"),$=a("c3a9"),C=a("08c8"),w=a("d6c6"),_=a("d5bc");const S={MapOnly:0,ManualControl:1};var x={name:"HomePage",inject:["showLoading","hideLoading","doAsk","showMessage","changeCacheRoute","checkEmergency"],components:{MessageDialog:_.a,QuestionDialog:w.a,ProgressDialog:C.a,InputDialog:$.a,UploadFileDialog:v.a,NoMapComponent:b.a,SpeedControl:M.a,ExcuteActionTaskModal:p.a,MapViewer:c.a,ManualControl:n.a,SelectDialog:y.a},data:function(){return{activeTab:"debug",ModelType:S,startLocationCallbackObject:{resolve:null,reject:null},cancelLocationCallbackObject:{resolve:null,reject:null},loading:!1,mapSavingProgressCheat:0,isMobile:this.$q.platform.is.mobile,intervalTimerId:0,callbackLoadMap:{resolve:null,reject:null},stdAction:l.n.NORMAL,funcAreaPreferenceList:[]}},computed:{...Object(s.f)(["isMapRedraw"]),...Object(s.d)(["isNotPartnerBeta"]),...Object(s.d)("srp",["hasRunningState","isSystemIdle","enableSystemControl"]),mapList:function(){return this.$store.getters["srp/robotMapList"]},curDisplayMapName:function(){return this.$store.getters["srp/displayedMapName"]},isPaused:function(){return this.$store.getters["srp/isMovementPaused"]||this.$store.getters["srp/isActionPaused"]||this.$store.getters["srp/isMissionPaused"]},locationState(){return this.$store.getters["srp/locationState"]},locationSucceed(){return this.$store.getters["srp/isLocationSucceed"]},displayedMapNameIsEqualSrosCurMapName(){return this.$store.getters["srp/displayedMapNameIsEqualSrosCurMapName"]},isMissionRunning(){return this.$store.getters["srp/isMissionRunning"]},isShowCtrlButtons(){return this.isConnected&&(!this.hasRunningState||this.isPaused)&&!this.isEditMapState&&this.enableSystemControl&&this.mapList.length>0},isConnected(){return this.$store.getters.isConnected},progress(){return this.mapSavingProgressCheat||this.$store.state.srp.systemState.mapSavingProgress},isSaveMap(){return this.$store.getters["srp/isNewMapSavingState"]},isDrawingMap(){return this.$store.getters["srp/isNewMapDrawingState"]},isIDrawMap(){return this.$store.getters.isDrawingMap>0},isEditMapState(){return this.$store.getters.isEditMap},isManualCtrl:{get:function(){return this.$store.getters["srp/isManualCtrlState"]},set:function(t){}},isTabDebug(){return"debug"===this.activeTab},rightDrawerState(){return this.$store.getters.rightDrawerState},isWorker(){return this.$store.getters["srp/isWorker"]},isDMCodeNavMode(){return this.$store.getters.isDMCodeNavMode},isCanManualControl(){return(this.isDrawingMap||this.isEditMapState||this.$store.getters["srp/isNotForkLiftRobot"]||!this.$store.state.isLimitManualControl)&&(!this.hasRunningState||this.isManualCtrl)&&!this.$store.getters["srp/isSysStateInitialing"]&&!this.$store.getters["srp/isOuterManualButtonState"]},isHomePage(){return"/homePage"===this.$route.path}},watch:{locationState(t,e){t===h.i.LOCATION_STATE_RUNNING?null!==this.startLocationCallbackObject.resolve&&this.startLocationCallbackObject.resolve():t===h.i.LOCATION_STATE_NONE&&null!==this.cancelLocationCallbackObject.resolve&&this.cancelLocationCallbackObject.resolve()},isSaveMap:async function(t,e){this.isMapRedraw||(t?this.$refs.progressDlg.showProgress(this.$t("text.saving")):e&&(this.mapSavingProgressCheat=100,await Object(u.Q)(3e3),this.switchToCreatedMap()))},isDrawingMap(t,e){t||this.mapOnly()},isEditMapState(t,e){this.changeEditMapState(t)}},mounted:async function(){if(this.changeCacheRoute({name:"HomePage",active:!0}),!this.$debug){const t=this.$i18n.locale.includes("zh")?"":"-en";this.$q.notify({progress:!0,color:"primary",message:`<a href="/statics/web_source/docs/mapIntroduce${t}.html" target="MapIntroduce.html">${this.$t("label.mapEditorSecondVersionIntroduce")}</a>`,html:!0,icon:"info",position:"top",actions:[{label:this.$t("label.IKnown"),color:"white"}]})}await Object(u.Q)(1e3),this.registerWatchDisplayMapName(),this.$nextTick(()=>{this.isManualCtrl&&["/homePage"].includes(this.$route.path)&&(this.unmountKeyboardEvent(),this.mountKeyboardEvent(),this.$notify({message:this.$t("text.manualControlAdjustSpeed"),timeout:3e3,type:"warning",position:"bottom"}))})},activated(){var t;null===(t=this.$refs.refMapViewer)||void 0===t||t.handleMapMaybeChange()},deactivated(){},async beforeRouteLeave(t,e,a){if(this.$store.state.token||!this.$store.getters.isEditMap||this.$store.getters.isManualLogout){if(this.$store.getters.isEditMap)return a(!1),void await this.$refs.messageDlg.doShowMessage({title:this.$t("label.notice"),message:this.$t("text.quitEditMap")});if(this.isDrawingMap&&this.isIDrawMap){let t=!1;try{await this.$refs.messageDlg.doShowMessage({title:this.$t("label.warning"),message:this.$t("text.isQuitWhenScanMap"),chooseButton:!0}),t=!0}catch(t){}if(!t)return void a(!1);try{await this.cancelScan()}catch(t){return void a(!1)}}a()}else a(!1)},beforeDestroy:function(){this.stopSaveMapDisplayInfoTimer(),this.saveMapDisplayInfo(),this.isIDrawMap&&this.mapOnly(),this.setUnloadCallback(!1),this.unmountKeyboardEvent()},methods:{...o.a,registerWatchDisplayMapName(){this.$watch("curDisplayMapName",(t,e)=>{this.updateDisplayMap(t,e)},{immediate:!0})},refreshMapList:async function(){try{await this.$store.dispatch("srp/getMapList")}catch(t){this.$notify({message:t.message,timeout:3e3,type:"negative",position:"top"})}},async updateDisplayMap(t="",e=""){var a;t&&"NO_MAP"!==t&&this.$el&&await(null===(a=this.$refs.refMapViewer)||void 0===a?void 0:a.toggleMap(t))},async asyncLoadMap(t="",e=""){let a=this.getMapReference();if("NO_MAP"!==e&&a.getMapName()===t)return;this.stopSaveMapDisplayInfoTimer(),this.loading=!0;let s=await this.loadMapJson(t);s?(s=await this.loadMapImage(t),s||(this.loading=!1)):this.loading=!1},async loadMapJson(t){try{let e=await Object(r.O)(t);return null!=e&&(await this.doLoadMapJson(t,e,!1),!0)}catch(t){let e="";switch(t){case g.d.LOAD_MAP_NETWORK_ERR:e=this.$t("text.networkError");break;case g.d.LOAD_MAP_JSON_ERR:e=this.$t("text.jsonError");break;case g.d.LOAD_MAP_IMG_ERR:e=this.$t("text.mapImageError")}return this.$notify({message:this.$t("text.loadMapFailed")+e,timeout:3e3,type:"negative",position:"top"}),!1}},async loadMapImage(t){try{let e=await Object(r.N)(t,this.$refs.map.mapImageScale());return this.doLoadMapImage(e),!0}catch(t){return this.$notify({message:this.$t("text.loadMapFailed")+t.message,timeout:3e3,type:"negative",position:"top"}),!1}},async syncLoadMap(t){return new Promise((e,a)=>{this.$store.commit("srp/setDisplayMapName",t),this.callbackLoadMap.resolve=e,this.callbackLoadMap.reject=a})},async createNewMap(){if(!await this.checkEmergency())return;if(Object(d.a)())return;let t="";try{t=await this.$refs.inputDialog.doInput({title:this.$t("text.inputCreateMapName"),value:""})}catch(t){return}Object(u.C)(t,this.$t("label.mapName"))&&(this.checkMapExist(t)?this.$notify({message:this.$t("text.mapHasExisted",{mapName:t}),timeout:3e3,type:"negative",position:"top"}):this.startScan(t))},async importMap(){try{await this.$refs.uploadFileDlg.doUploadFile(u.z.FILE_MAP_PKG),await this.refreshMapList(),this.$notify({message:this.$t("text.succeedImportMap"),timeout:3e3,type:"positive",position:"top"})}catch(t){if(t)return;this.$notify({message:this.$t("text.failImportMap"),timeout:3e3,type:"negative",position:"top"})}},focusOnMap(){this.$refs.refMapViewer.focusOnMap()},async doLoadMapJson(t,e,a=!1){let s=this.getMapReference();null!=s&&(e.hasOwnProperty("private")?(e.private.hasOwnProperty("fuseLocateQRCode")||(e.private.fuseLocateQRCode=[]),e.private.hasOwnProperty("cleanArea")||(e.private.cleanArea=[])):e.private={cleanArea:[],fuseLocateQRCode:[]},this.isDMCodeNavMode&&(a||(e.private.fuseLocateQRCode=await Object(r.Z)(t)),e.private.fuseLocateQRCode.forEach(t=>{t.type=g.e.QRCODE_TYPE_FUSE_LOCATE})),s.loadMapJson(t,e,a))},doLoadMapImage(t){let e=this.getMapReference();null!=e&&e.loadMapImage(t)},doAfterLoadMap(){let t=this.getMapReference();if(null==t)return;this.$store.commit("setMapLoadedState",!0),t.updateNavPath(this.navPath),t.updateRobotPos(this.robotPose);let e=f.a.getMapDisplayInfo(this.curDisplayMapName);e&&t.setMapDisplayInfo(e),this.startSaveMapDisplayInfoTimer()},getMapReference(){return void 0!==this.$refs.map?this.$refs.map:null},loadMapFinished:async function(t){t===g.d.LOAD_MAP_OK?(this.doAfterLoadMap(),null!==this.callbackLoadMap.resolve&&(this.callbackLoadMap.resolve(t),this.callbackLoadMap.resolve=null)):(this.$notify({message:this.$t("text.loadMapFailed"),timeout:3e3,type:"negative",position:"top"}),null!==this.callbackLoadMap.reject&&(this.callbackLoadMap.reject(t),this.callbackLoadMap.reject=null));let e=await Object(r.M)(this.curDisplayMapName),a=this.getMapReference();a&&a.addLmkList(e),this.loading=!1},async startScan(t){try{this.$store.getters["srp/isManualCtrlState"]||await this.$store.dispatch("srp/requestEnableManualControl",!0),await i.d.startCreateNewMap(t),this.$notify({message:this.$t("text.manualControlToScanMap"),timeout:3e3,type:"info",position:"top"}),await this.$store.commit("setCreateMapName",t),await this.$store.commit("setDrawingMap",1),this.$router.push({path:"/manualcontrol"})}catch(t){this.$notify({message:this.$t("text.failCreateMap")+t.message,timeout:3e3,type:"negative",position:"top"})}},startSaveMapDisplayInfoTimer(){this.stopSaveMapDisplayInfoTimer(),this.intervalTimerId=setInterval(()=>{this.saveMapDisplayInfo()},3e3)},stopSaveMapDisplayInfoTimer(){clearInterval(this.intervalTimerId),this.intervalTimerId=0},async switchToCreatedMap(){await this.refreshMapList();let t=this.$store.getters.getCreateMapName;await Object(r.xb)(t)||this.$notify({message:this.$t("text.failUpdateMapGroup"),timeout:1500,type:"negative",position:"top"}),this.mapSavingProgressCheat=0,this.$refs.progressDlg.hideProgress(),this.$store.commit("srp/setDisplayMapName",""),this.$notify({message:this.$t("text.succeedCreateMap"),timeout:3e3,type:"positive",position:"top"}),this.$store.commit("srp/setDisplayMapName",t)},async onSaveMap(t){if(this.$store.getters["srp/isLockedState"]&&!this.$store.getters["srp/isLockedByMyself"])return void this.$notify({message:this.$t("text.systemUnavailable")+this.$t("text.failSaveMap"),timeout:1500,type:"negative",position:"top"});this.loading=!0;let e=t.mapName,a=t.mapJson;if(this.$store.getters.isConnected){let t=!1,s=!this.isDMCodeNavMode||Object(r.Cb)({mapName:e,fuseLocateQRCode:[...a.private.fuseLocateQRCode]});delete a.private.fuseLocateQRCode,t=await Promise.all([s,Object(r.rb)(e,a)]).then(t=>t.every(t=>t)),t&&this.$refs.refMapViewer.setSaveMapState(),this.changeCacheRoute({name:"ManualControlPage",active:!1}),this.displayedMapNameIsEqualSrosCurMapName&&u.e.emit(u.f.UpdateSrosMap)}else this.$notify({message:this.$t("text.networkError"),timeout:1500,type:"negative",position:"top"});this.loading=!1},onExitEditMap(){this.$store.commit("setEditMapState",!1)},mapStations(){var t;return(null===(t=this.$refs.refMapViewer)||void 0===t?void 0:t.stations)||[]},async cancelScan(){if(await this.doAsk({title:this.$t("label.cancelCreateMap"),question:this.$t("text.confirmCancelcreateMap")}))try{this.showLoading(this.$t("text.cancellingCreateMap")),await this.$store.dispatch("srp/requestEnableManualControl",!1),await i.d.cancelCreateNewMap(),this.hideLoading(),this.$notify({message:this.$t("text.succeedCancelCreateMap"),timeout:3e3,type:"info",position:"top"})}catch(t){this.hideLoading(),this.$notify({message:this.$t("text.failCancelCreateMap")+t.message,timeout:3e3,type:"negative",position:"top"})}},async finishScan(){if(await this.doAsk({title:this.$t("button.finishScan"),question:this.$t("text.confirmFinishCreateMap")}))try{this.showLoading(this.$t("label.finishingScan")),await this.$store.dispatch("srp/requestEnableManualControl",!1),await i.d.finishCreateNewMap(),this.hideLoading()}catch(t){this.hideLoading(),this.$notify({message:this.$t("text.failFinishScanMap")+t.message,timeout:3e3,type:"negative",position:"top"})}},checkMapExist(t){let e=this.$store.getters["srp/robotMapList"];for(let a of Array.from(e))if(a.name===t)return!0;return!1},async setManualCtrl(t){if(this.loading=!0,!this.isManualCtrl&&t){if(Object(d.c)()||!Object(d.e)())return void(this.loading=!1);try{await this.$store.dispatch("srp/requestEnableManualControl",!0),this.$notify({message:this.$t("text.automaticallyExitManualControlTip"),timeout:3e3,type:"warning",position:"bottom"}),this.$notify({message:this.$t("text.manualControlAdjustSpeed"),timeout:3e3,type:"warning",position:"bottom"})}catch(t){this.$notify({message:this.$t("text.failManualControl")+t.message,timeout:3e3,type:"negative",position:"top"})}}else if(this.isManualCtrl&&!t)try{this.$store.state.srp.systemState.operationState===h.m.OPERATION_MANUAL&&await this.$store.dispatch("srp/requestEnableManualControl",!1)}catch(t){this.$notify({message:this.$t("text.failCancelManualControl")+t.message,timeout:3e3,type:"negative",position:"top"})}this.loading=!1},onChangeManualCtrl(t){this.isCanManualControl&&this.setManualCtrl(t)},mapOnly(){this.setManualCtrl(!1),this.$store.commit("setDrawingMap",0)},checkDisplayMap(){return!!this.displayedMapNameIsEqualSrosCurMapName||(this.$notify({message:this.$t("text.displayMapMismatchLocationMap"),timeout:3e3,type:"negative",position:"top"}),!1)},async changeEditMapState(t){if(this.isHomePage){if(t){if(0===this.funcAreaPreferenceList.length){const t=await Object(r.lb)("preference_config");Array.isArray(t)&&(this.funcAreaPreferenceList=t)}this.$refs.refMapViewer.setFuncAreaPreference(this.funcAreaPreferenceList)}this.setUnloadCallback(t),Object(g.y)()}},setUnloadCallback(t){window.onbeforeunload=t?async function(t){return(t=t||window.event)&&(t.returnValue=""),""}:null},loadCurrentMap(){let t=this.$store.getters["srp/mapName"];""!==t&&"NO_MAP"!==t&&void 0!==this.$el?this.$store.commit("srp/setDisplayMapName",t):this.$notify({message:this.$t("text.askToLocateWhenLoadMap"),timeout:3e3,type:"info",position:"top"})},async onLaserPointsStateChanged(t){try{await this.$store.dispatch("srp/setAutoUploadLaserPoint",t)}catch(t){}},async onAvoidRectangleStateChanged(t){try{await this.$store.dispatch("srp/setAutoUploadAvoidRectangleList",t)}catch(t){}},async onRecognitionStateChanged(t,e,a){await i.d.enableFeatureDebug(t,e),a||this.$store.commit("srp/onNewFeatureInfoUpload",[])},async moveToStation(){let t;if(await this.checkEmergency()&&!(Object(d.b)()||Object(d.f)()||Object(d.a)()||Object(d.h)())&&this.checkDisplayMap()){await this.setManualCtrl(!1);try{let e=[];this.mapStations().forEach(t=>{e.push({label:t.label+" (#"+t.id+")",value:t.id})}),t=await this.$refs.selectDlg.doSelect({title:this.$t("button.moveToStation"),options:e,desc:this.$t("text.chooseStation")})}catch(t){return}this.doMoveToStation(t)}},async moveToStationFromMenu(t){await this.checkEmergency()&&(Object(d.b)()||Object(d.f)()||Object(d.a)()||Object(d.h)()||!this.checkDisplayMap()||this.doMoveToStation(t))},async doMoveToStation(t){try{await i.d.moveToStation(t),this.$notify({message:this.$t("text.sendSucceed"),timeout:3e3,type:"positive",position:"top"})}catch(t){this.showMessage({title:this.$t("button.moveToStation"),message:this.$t("text.sendFailed")+t.message})}},async moveToPos(){var t;await this.checkEmergency()&&(Object(d.b)()||Object(d.f)()||Object(d.a)()||Object(d.h)()||!this.checkDisplayMap()||(await this.setManualCtrl(!1),this.$notify({message:this.$t("text.setMoveToPose"),timeout:3e3,type:"info",position:"top"}),this.stdAction=l.n.MOVE_POSE,null===(t=this.$refs.refMapViewer)||void 0===t||t.setInteraction(this.stdAction)))},async doMovePose(t){let e=!1;try{e=await this.$refs.questionDlg.doAsk({title:this.$t("button.moveToPose"),question:this.$t("text.confirmMoveToPose",{x:(t.x/1e3).toFixed(2),y:(t.y/1e3).toFixed(2),yaw:Object(g.h)(t.yaw/1e3).toFixed(2)})})}catch(t){return}if(e)try{await i.d.moveTo(t),this.$notify({message:this.$t("text.sendSucceed"),timeout:3e3,type:"positive",position:"top"})}catch(t){this.showMessage({title:this.$t("button.moveToPose"),message:this.$t("text.sendFailed")+t.message})}},async setCurStationNo(){if(Object(d.b)()||Object(d.f)()||Object(d.a)()||Object(d.h)()||!this.checkDisplayMap())return;let t;await this.setManualCtrl(!1);try{let e=[];this.mapStations().forEach(t=>{e.push({label:t.label,value:t.id})}),t=await this.$refs.selectDlg.doSelect({title:this.$t("label.setCurrentStation"),options:e,desc:this.$t("text.chooseStation")})}catch(t){return}try{await i.d.setCurStationNo(t),this.$notify({message:this.$t("text.succeedSetCurrentStation"),timeout:3e3,type:"positive",position:"top"})}catch(t){this.$notify({message:this.$t("text.failSetCurrentStation")+t.message,timeout:3e3,type:"negative",position:"top"})}},async startLocation(){var t;if(this.locationSucceed)try{if(await this.$refs.questionDlg.doAsk({title:this.$t("label.locate"),question:this.$t("text.stopLocateWhenIsLocated")}),!await this.stopLocation())return}catch(t){return}if(!this.displayedMapNameIsEqualSrosCurMapName)try{await i.d.setCurrentMap(this.curDisplayMapName)}catch(t){return void this.$notify({message:this.$t("text.failSetCurrentMap"),timeout:3e3,type:"negative",position:"top"})}await this.setManualCtrl(!1),this.$notify({message:this.$t("text.setLocationPose"),timeout:3e3,type:"info",position:"top"}),this.stdAction=l.n.MANUAL_LOCATE,null===(t=this.$refs.refMapViewer)||void 0===t||t.setInteraction(this.stdAction)},async startLocationSend(t){this.showLoading(this.$t("label.locating"));try{await i.d.startLocation(t)}catch(t){return this.$notify({message:this.$t("text.failStartLocation")+t.message,timeout:3e3,type:"negative",position:"top"}),void this.hideLoading()}try{await Object(u.B)(()=>{},this.startLocationCallbackObject,2*u.w),this.$notify({message:this.$t("text.succeedLocation"),timeout:3e3,type:"positive",position:"top"})}catch(t){this.$notify({message:this.$t("text.failLocation")+this.$t("label.timeout"),timeout:3e3,type:"negative",position:"top"})}this.hideLoading()},async startLocationByStationNo(){if(this.locationSucceed)try{if(await this.$refs.questionDlg.doAsk({title:this.$t("label.locate"),question:this.$t("text.stopLocateWhenIsLocated")}),!await this.stopLocation())return}catch(t){return}if(Object(d.h)())return;if(!this.displayedMapNameIsEqualSrosCurMapName)try{await i.d.setCurrentMap(this.curDisplayMapName)}catch(t){return void this.$notify({message:this.$t("text.failSetCurrentMap"),timeout:3e3,type:"negative",position:"top"})}let t;await this.setManualCtrl(!1);try{let e=[];this.mapStations().forEach(t=>{e.push({label:t.label,value:t.id})}),t=await this.$refs.selectDlg.doSelect({title:this.$t("label.locate"),desc:this.$t("text.chooseStation"),options:e})}catch(t){return}this.showLoading(this.$t("label.locating"));try{await i.d.startLocationByStationNo(t)}catch(t){return this.$notify({message:this.$t("text.failStartLocation")+t.message,timeout:3e3,type:"negative",position:"top"}),void this.hideLoading()}try{await Object(u.B)(()=>{},this.startLocationCallbackObject,2*u.w),this.$notify({message:this.$t("text.succeedLocation"),timeout:3e3,type:"positive",position:"top"})}catch(t){this.$notify({message:this.$t("text.failLocation")+this.$t("label.timeout"),timeout:3e3,type:"negative",position:"top"})}this.hideLoading()},async stopLocation(){if(!this.locationSucceed)return this.$notify({message:this.$t("text.locationNotStart"),timeout:3e3,type:"negative",position:"top"}),!1;await this.setManualCtrl(!1),this.showLoading(this.$t("text.stoppingLocation"));try{await i.d.stopLocation()}catch(t){return this.$notify({message:this.$t("text.failStopLocation")+t.message,timeout:3e3,type:"negative",position:"top"}),this.hideLoading(),!1}try{await Object(u.B)(()=>{},this.cancelLocationCallbackObject,u.v),this.$notify({message:this.$t("text.succeedStopLocation"),timeout:3e3,type:"positive",position:"top"})}catch(t){return this.$notify({message:this.$t("text.failStopLocation"),timeout:3e3,type:"negative",position:"top"}),this.hideLoading(),!1}return this.hideLoading(),!0},excuteAction(){Object(d.b)()||Object(d.h)()||!this.checkDisplayMap()||(this.setManualCtrl(!1),this.$refs.exeActionDialog.opened=!0)},async pauseTask(){try{if(this.isMissionRunning)return void await m.a.pause();await i.d.pauseMovement()}catch(t){this.$notify({message:this.$t("text.failPauseTask")+t.message,timeout:3e3,type:"negative",position:"top"})}},async continueTask(){if(!(Object(d.b)()||Object(d.f)()||Object(d.c)()||Object(d.a)()))try{if(this.isMissionRunning)return void await m.a.continueMission();await i.d.continueMovement()}catch(t){this.$notify({message:this.$t("text.failContinueTask")+t.message,timeout:3e3,type:"negative",position:"top"})}},async stopTask(){try{if(this.isMissionRunning){let t=this.$store.getters["srp/curMissionNo"];return void await m.a.stop(t)}await i.d.cancelTask()}catch(t){this.$notify({message:this.$t("text.failCancelTask")+t.message,timeout:3e3,type:"negative",position:"top"})}},async checkUnsavedMission(){let t=f.a.getMission();if(null==t||t.isOnline)return;t.mission;let e=!1;try{await this.$refs.messageDlg.doShowMessage({title:this.$t("label.notice"),message:this.$t("text.isRecoverFromEditMap"),okayTxt:this.$t("label.yes"),chooseButton:!0}),e=!0}catch(t){e=!1}if(e){let t=f.a.getMission(),e=null;if(null===t||t.isOnline||(e=t.mission,e.map_name=e.mapName,delete e.mapName),null==e)return;let a=await Object(r.Q)(e.map_name);this.$router.push({path:"/taskedit",query:{isEditable:1,stations:JSON.stringify(a),missionDat:JSON.stringify(e)}}),this.$notify({message:this.$t("text.noticeSaveMission"),timeout:3e3,type:"warning",position:"top"})}else f.a.removeMission()},async checkUnsavedMap(){let t=f.a.getMap();if(null==t||t.isOnline)return;if(!this.checkMapExist(t.name))return void f.a.removeMap();let e=!1;try{await this.$refs.messageDlg.doShowMessage({title:this.$t("label.notice"),message:this.$t("text.isRecoverFromEditMission"),chooseButton:!0,okayTxt:this.$t("label.yes")}),e=!0}catch(t){e=!1}e?(this.curDisplayMapName!==t.name&&await this.syncLoadMap(t.name),this.loading=!0,this.doLoadMapJson(t.name,t.json,!0),await this.loadMapImage(t.name),this.changeEditMapState(),this.loading=!1,await this.$refs.messageDlg.doShowMessage({title:this.$t("label.notice"),message:this.$t("text.noticeSaveMap")}),f.a.removeMap()):f.a.removeMap()},saveToLocal:function(t,e,a){f.a.setMap(t,e,a)},saveMapDisplayInfo(){let t=this.getMapReference();null!=t&&f.a.setMapDisplayInfo(t.getDisplayInfo())},recordCurPgvInfo(){if(null==this.getMapReference())return;let t=this.$store.getters["srp/curBarCodeInfo"];t.pgvId&&"0"!==t.pgvId&&this.$refs.map.recordDMCode({...t,type:g.e.QRCODE_TYPE_PGV})},locateMovePoseFn(t){switch(this.stdAction){case l.n.MOVE_POSE:this.doMovePose(t);break;case l.n.MANUAL_LOCATE:this.startLocationSend(t)}},setPageAction(t){this.stdAction=t}}},L=(a("64fe"),a("2877")),O=a("9989"),k=a("9c40"),D=a("f09f"),q=a("429b"),N=a("7460"),T=a("0016"),P=a("adad"),E=a("823b"),j=a("e7a9"),A=a("de5e"),I=a("74f7"),R=a("d9b2"),F=a("eebe"),Q=a.n(F),B=Object(L.a)(x,function(){var t=this,e=t._self._c;return e("q-page",{staticClass:"background_grey",staticStyle:{border:"1px solid #f0f1f5"},attrs:{id:"homePageId"}},[e("map-viewer",{ref:"refMapViewer",on:{saveMap:t.onSaveMap,exitEdit:t.onExitEditMap,locateMovePoseFn:t.locateMovePoseFn,selectStation:t.moveToStationFromMenu,moveToPos:t.moveToPos,setPageAction:t.setPageAction}}),t.mapList.length<=0&&t.isSystemIdle?e("no-map-component",{on:{createMap:t.createNewMap,importMap:t.importMap}}):t._e(),t.isWorker?t._e():e("div",[t.isDrawingMap?e("div",{staticClass:"q-mt-md"},[e("div",{staticClass:"row flex flex-center"},[e("q-btn",{staticClass:"default_button_style",staticStyle:{margin:"10px"},attrs:{"no-caps":"",unelevated:"",color:"negative"},on:{click:t.cancelScan}},[e("div",{staticClass:"text_main_white_style"},[t._v(t._s(t.$t("button.cancel")))])]),e("q-btn",{staticClass:"default_button_style",staticStyle:{margin:"10px"},attrs:{"no-caps":"",unelevated:"",icon:"done",color:"positive"},on:{click:t.finishScan}},[e("div",{staticClass:"text_main_white_style"},[t._v(t._s(t.$t("button.finishScan")))])])],1)]):e("div",{staticStyle:{position:"absolute",top:"0px",left:"4px","pointer-events":"none",opacity:"0.98"}},[e("q-card",{staticClass:"q-mt-sm q-ml-md no-shadow",staticStyle:{"pointer-events":"auto"}},[t.isShowCtrlButtons?e("div",{staticClass:"q-mb-md"},[t.isMobile?e("div",{staticStyle:{width:"350px",opacity:"0.8"}},[e("q-btn",{staticClass:"bg-grey-1 full-width",staticStyle:{height:"32px"},attrs:{unelevated:""}},[e("div",{staticClass:"text_main_grey_style text-center"},[t._v("\n                "+t._s(t.$t("label.debugByStep")+" | "+t.$t("label.locate"))+"\n              ")])]),e("div",{staticClass:"row flex justify-between q-pa-sm"},[e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",round:"",dense:"",color:"grey-6"},on:{click:t.moveToStation}},[e("q-icon",{staticClass:"std_move_to_station_white"})],1),e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",round:"",dense:"",color:"grey-6"},on:{click:t.moveToPos}},[e("q-icon",{staticClass:"std_move_to_pose_white"})],1),e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",unelevated:"",round:"",dense:"",color:"grey-6"},on:{click:t.excuteAction}},[e("q-icon",{staticClass:"std_execute_action_white"})],1),e("div",{staticClass:"bg-grey-5",staticStyle:{width:"1px",height:"32px"}}),e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",unelevated:"",round:"",dense:"",color:"grey-6"},on:{click:t.startLocation}},[e("q-icon",{staticClass:"std_pose_location_white"})],1),e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",unelevated:"",round:"",dense:"",color:"grey-6"},on:{click:t.startLocationByStationNo}},[e("q-icon",{staticClass:"std_station_location_white"})],1),e("q-btn",{staticClass:"no-shadow",attrs:{"no-caps":"",unelevated:"",round:"",dense:"",color:"grey-6"},on:{click:t.stopLocation}},[e("q-icon",{staticClass:"std_cancel_location_white"})],1)],1)],1):e("div",[e("q-tabs",{staticClass:"bg-grey-1",attrs:{dense:"","no-caps":"","inline-label":"",shrink:"","active-bg-color":"white","indicator-color":"white",align:"justify"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("q-tab",{style:t.isMobile?"width: 150px;":"width: 200px;",attrs:{name:"debug"},nativeOn:{click:function(e){return t.mapOnly.apply(null,arguments)}}},[e("q-icon",{staticClass:"q-mr-sm",class:t.isTabDebug?"std_debug_blue":"std_debug_grey"}),e("div",{class:t.isTabDebug?"text_main_blue_style":"text_main_grey_style"},[t._v("\n                  "+t._s(t.$t("label.debugByStep"))+"\n                ")])],1),e("q-tab",{style:t.isMobile?"width: 150px;":"width: 200px;",attrs:{name:"location"},nativeOn:{click:function(e){return t.mapOnly.apply(null,arguments)}}},[e("q-icon",{staticClass:"q-mr-sm",class:t.isTabDebug?"std_location_grey":"std_location_blue",attrs:{size:"16px"}}),e("div",{class:t.isTabDebug?"text_main_grey_style":"text_main_blue_style"},[t._v("\n                  "+t._s(t.$t("label.locate"))+"\n                ")])],1)],1),t.isShowCtrlButtons?e("q-tab-panels",{attrs:{animated:!1,"transition-next":"slide-left"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("q-tab-panel",{staticClass:"q-pa-sm",attrs:{name:"debug"}},[e("q-btn-group",{attrs:{outline:"",stretch:""}},[e("q-btn",{staticClass:"no-border",attrs:{"no-caps":"",unelevated:"",outline:"",color:"transparent",disable:!t.displayedMapNameIsEqualSrosCurMapName},on:{click:t.moveToStation}},[e("q-icon",{staticClass:"std_move_to_station"}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v("\n                      "+t._s(t.$t("button.moveToStation"))+"\n                    ")])],1),e("q-btn",{staticClass:"no-border",attrs:{outline:"",unelevated:"","no-caps":"",color:"transparent",disable:!t.displayedMapNameIsEqualSrosCurMapName},on:{click:t.moveToPos}},[e("q-icon",{staticClass:"std_move_to_pos"}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v(t._s(t.$t("button.moveToPose")))])],1),e("q-btn",{staticClass:"no-border",attrs:{outline:"","no-caps":"",unelevated:"",color:"transparent"},on:{click:t.excuteAction}},[e("q-icon",{staticClass:"std_execute_action"}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v("\n                      "+t._s(t.$t("label.executeAction"))+"\n                    ")])],1)],1)],1),e("q-tab-panel",{staticClass:"q-pa-sm",attrs:{name:"location"}},[e("q-btn-group",{attrs:{outline:"",stretch:""}},[e("q-btn",{staticClass:"no-border",attrs:{outline:"","no-caps":"",unelevated:"",color:"transparent"},on:{click:t.startLocation}},[e("q-icon",{staticClass:"std_pose_location",attrs:{size:"16px"}}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v("\n                      "+t._s(t.$t("button.locateByPose"))+"\n                    ")])],1),e("q-btn",{staticClass:"no-border",attrs:{outline:"","no-caps":"",unelevated:"",color:"transparent"},on:{click:t.startLocationByStationNo}},[e("q-icon",{staticClass:"std_station_location"}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v("\n                      "+t._s(t.$t("button.locateByStation"))+"\n                    ")])],1),e("q-btn",{staticClass:"no-border",attrs:{outline:"","no-caps":"",unelevated:"",color:"transparent"},on:{click:t.stopLocation}},[e("q-icon",{staticClass:"std_cancel_location",attrs:{size:"16px"}}),e("div",{staticClass:"text_main_grey_style q-ml-sm"},[t._v("\n                      "+t._s(t.$t("button.stopLocation"))+"\n                    ")])],1)],1)],1)],1):t._e()],1)]):t._e()]),e("div",{staticClass:"row inline q-ml-md"},[t.isNotPartnerBeta&&t.hasRunningState&&!t.isEditMapState&&t.isConnected?e("div",{staticClass:"full-height float-right",staticStyle:{"pointer-events":"auto"},attrs:{outline:""}},[t.isPaused?t._e():e("q-btn",{staticClass:"move_ctrl_btn_style text_main_grey_style q-mr-md",attrs:{"no-caps":"",unelevated:"",label:t.$t("button.pause")},on:{click:t.pauseTask}}),t.isPaused?e("q-btn",{staticClass:"move_ctrl_btn_style text_main_grey_style q-mr-md",attrs:{"no-caps":"",unelevated:"",label:t.$t("button.continueExe")},on:{click:t.continueTask}}):t._e(),e("q-btn",{staticClass:"move_ctrl_btn_style text_main_grey_style",attrs:{"no-caps":"",unelevated:"",label:t.$t("button.stop")},on:{click:t.stopTask}})],1):t._e()])],1)]),t.isNotPartnerBeta&&t.enableSystemControl?[t.isWorker?t._e():e("q-page-sticky",{attrs:{position:"bottom-left",offset:[0,70]}},[e("div",{staticClass:"q-mt-md q-ml-md column"},[t.isCanManualControl&&t.isManualCtrl?e("manual-control",{staticClass:"q-mb-md",class:{"orientation-portrait":t.$q.platform.is.mobile},staticStyle:{"pointer-events":"auto"}}):t._e()],1)]),e("speed-control",{attrs:{isCanManualControl:t.isCanManualControl},on:{"focus:speed":t.focusOnMap,onChangeManualCtrl:t.setManualCtrl}})]:t._e(),e("upload-file-dialog",{ref:"uploadFileDlg"}),e("input-dialog",{ref:"inputDialog"}),e("excute-action-task-modal",{ref:"exeActionDialog"}),e("SelectDialog",{ref:"selectDlg"}),e("progress-dialog",{ref:"progressDlg",attrs:{progress:t.progress}}),e("question-dialog",{ref:"questionDlg"}),e("message-dialog",{ref:"messageDlg"}),e("q-inner-loading",{attrs:{showing:t.loading}},[e("q-spinner-ios",{attrs:{size:"50px",color:"primary"}})],1)],2)},[],!1,null,"be685cdc",null);e.default=B.exports;Q()(B,"components",{QPage:O.a,QBtn:k.a,QCard:D.a,QTabs:q.a,QTab:N.a,QIcon:T.a,QTabPanels:P.a,QTabPanel:E.a,QBtnGroup:j.a,QPageSticky:A.a,QInnerLoading:I.a,QSpinnerIos:R.a})},ef58:function(t,e,a){}}]);