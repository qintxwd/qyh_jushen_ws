(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0a96":function(e,t,a){"use strict";a.r(t);a("f665"),a("ab43");var n=a("2b0e"),l=a("4300"),s=a("8847"),r=a("adb7"),o={__name:"MapSearchTool",props:{stations:{type:Array,default:()=>[]},edges:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},nodes:{type:Array,default:()=>[]},locationAreas:{type:Array,default:()=>[]},noteAreas:{type:Array,default:()=>[]},tags:{type:Array,default:()=>[]},dmCodes:{type:Array,default:()=>[]},edgeGroups:{type:Array,default:()=>[]}},emits:["search:select"],setup(e,{emit:t}){const a=e,o=Object(n.ref)(r.g.NONE),c=Object(n.ref)([{value:r.g.NONE,label:s.b.t("label.allText")},{value:r.g.STATION,label:s.b.t("label.station")},{value:r.g.NODE,label:s.b.t("label.node")},{value:r.g.EDGE,label:s.b.t("label.edge")},{value:r.g.FUNC_AREA,label:s.b.t("label.funcRegion")},{value:r.g.NOTE_AREA,label:s.b.t("label.noteArea")},{value:r.g.DMCODE,label:s.b.t("label.barcode")},{value:r.g.EDGE_GROUP,label:s.b.t("label.edgeGroup")},{value:r.g.TAG,label:s.b.t("label.tag")}]),i=Object(n.computed)(()=>c.value.find(e=>e.value===o.value).label),u=Object(n.ref)(-1),d=Object(n.ref)(""),p={includeMatches:!0,threshold:.4,keys:["id","label"]},b=Object(n.computed)(()=>{const e={[r.g.NONE]:[...a.stations,...a.nodes,...a.edges,...a.areas,...a.noteAreas,...a.dmCodes,...a.edgeGroups,...a.tags],[r.g.STATION]:a.stations,[r.g.NODE]:a.nodes,[r.g.EDGE]:a.edges,[r.g.FUNC_AREA]:a.areas,[r.g.NOTE_AREA]:a.noteAreas,[r.g.DMCODE]:a.dmCodes,[r.g.EDGE_GROUP]:a.edgeGroups,[r.g.TAG]:a.tags}[o.value];if(!d.value)return[];return new l.a(e,p).search(d.value).map(({item:e})=>e)}),m=Object(n.computed)(()=>b.value.length>0);Object(n.watch)(b,(e,t)=>{e!==t&&y(-1)});const y=(e=0)=>{if(u.value===e)return;u.value=e;const a=b.value[e];if(a){const{key:e,id:n,type:l}=a,s=document.getElementById(e);s&&s.scrollIntoView({behavior:"smooth"}),t("search:select",{id:n,type:l})}},f=()=>{y(Math.max(u.value-1,0))},g=()=>{y(Math.min(u.value+1,b.value.length-1))};return{__sfc:!0,props:a,emit:t,elementType:o,elementTypeOptions:c,elementTypeLabel:i,changeElementType:e=>{o.value=e},currentIndex:u,keywords:d,fuseOptions:p,searchResults:b,hasSearchResults:m,setCurrentIndex:y,onSearchKeydown:e=>{const{key:t}=e;["ArrowDown","ArrowUp"].includes(t)&&(e.preventDefault(),e.stopPropagation()),"ArrowDown"===t?g():"ArrowUp"===t&&f()},onPrevious:f,onNext:g}}},c=(a("38c5"),a("2877")),i=a("1c1c"),u=a("66e5"),d=a("27f9"),p=a("0016"),b=a("9c40"),m=a("4e73"),y=a("4074"),f=a("0170"),g=a("7f67"),v=a("714f"),h=a("eebe"),w=a.n(h),A=Object(c.a)(o,function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("q-list",{staticClass:"map-search-container round q-mt-sm",attrs:{dense:""}},[t("q-item",{staticClass:"full-width no-padding"},[t("q-input",{staticClass:"full-width bg-white rounded-borders",attrs:{type:"search",debounce:"500",dense:"",outlined:"","hide-bottom-space":"",borderless:"",color:"primary"},on:{keydown:a.onSearchKeydown},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"search"}}),t("q-btn",{attrs:{dense:"",label:a.elementTypeLabel,flat:""}},[t("q-menu",[t("q-list",e._l(a.elementTypeOptions,function({value:n,label:l}){return t("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:n,attrs:{clickable:""}},[t("q-item-section",{on:{click:function(e){return a.changeElementType(n)}}},[e._v(e._s(l))])],1)}),1)],1)],1)]},proxy:!0},{key:"append",fn:function(){return[a.keywords?t("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-close"},on:{click:function(e){a.keywords=""}}}):e._e(),a.hasSearchResults?[t("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-chevron-up"},on:{click:a.onPrevious}}),t("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-chevron-down"},on:{click:a.onNext}})]:e._e()]},proxy:!0}]),model:{value:a.keywords,callback:function(e){a.keywords="string"==typeof e?e.trim():e},expression:"keywords"}})],1),a.keywords?t("div",{staticClass:"search-result-container bg-white"},[a.hasSearchResults?e._l(a.searchResults,function({key:n,label:l},s){return t("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:"",active:a.currentIndex===s,id:n},on:{click:function(e){return a.setCurrentIndex(s)}}},[t("q-item-section",[t("q-item-label",[e._v(e._s(l))])],1)],1)}):t("q-item",{attrs:{dense:""}},[t("q-item-section",[t("q-item-label",[e._v(e._s(e.$q.lang.table.noData))])],1)],1)],2):e._e()],1)},[],!1,null,"2d76ae42",null);t.default=A.exports;w()(A,"components",{QList:i.a,QItem:u.a,QInput:d.a,QIcon:p.a,QBtn:b.a,QMenu:m.a,QItemSection:y.a,QItemLabel:f.a}),w()(A,"directives",{ClosePopup:g.a,Ripple:v.a})},"38c5":function(e,t,a){"use strict";a("c95b")},c95b:function(e,t,a){}}]);